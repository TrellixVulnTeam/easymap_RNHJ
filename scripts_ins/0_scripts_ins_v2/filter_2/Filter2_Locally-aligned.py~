#To change directories in windows:
import os
os.chdir('C:\Python27\TDNA')

#Now we select in the .sam file the unpaired reads whose mates are paired 
with open('local_lecturas_a_TDNA.sam') as f1: #We open the input file and create the output, both as objects (f1, f2)
	with open('output_F2.fq', 'w') as f2:
		lines = f1.readlines() 
		for i, line in enumerate(lines):#To read through the lines of the file
			if not line.startswith('@'): #We create a contition to eliminate the headers in the sam file
				sp = line.split() #Now we split each line into an array 
				if 'S' in sp[5]:
						f2.write('@'+sp[0] + '\n' + sp[9] + '\n' + '+' + '\n' + sp[10] + '\n' ) #The selected reads are written as a fastq file
f2.close()	
